(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 14.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     51021,       1109]
NotebookOptionsPosition[     44169,       1005]
NotebookOutlinePosition[     44566,       1021]
CellTagsIndexPosition[     44523,       1018]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["MSSM-to-SMEFT matching at one-loop order", "Title",ExpressionUUID->"8d0e942e-f42f-46c2-a346-91d4d9eef4e9"],

Cell["\<\
Works  on  Matchete  git commit \[OpenCurlyDoubleQuote]46ec78a7\
\[CloseCurlyDoubleQuote]:
[ https://gitlab.com/matchete/matchete/-/commit/\
46ec78a79dfd73d1ef238dfcea8df37a3b8744be ]\
\>", "Subtitle",
 CellChangeTimes->{
  3.950708290156095*^9, {3.950708331218625*^9, 3.950708351631042*^9}, {
   3.950792497955055*^9, 3.9507925043767633`*^9}, 3.950845302423027*^9, 
   3.950845627741718*^9, 3.950845664515609*^9, {3.9567255827301807`*^9, 
   3.956725585679935*^9}},ExpressionUUID->"7dc2047a-b130-4bef-ac0f-\
9e9bac102269"],

Cell[CellGroupData[{

Cell["Loading Matchete", "Section",
 CellChangeTimes->{{3.950756431590049*^9, 
  3.950756446483245*^9}},ExpressionUUID->"f2c594f8-f2e1-4d7c-b35e-\
abcc6d951b3b"],

Cell[BoxData[
 RowBox[{"<<", "Matchete`"}]], "Input",
 CellChangeTimes->{{3.9507070784688997`*^9, 3.9507070822808437`*^9}, {
  3.9507084023320293`*^9, 3.950708402828046*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"862068ec-e0dd-4bfd-8dd7-9edc23e74121"],

Cell[BoxData[
 TemplateBox[{
   TemplateBox[{7}, "Spacer1"], 
   StyleBox[
    GraphicsBox[{
      Thickness[0.001364256480218281], 
      StyleBox[{
        FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 
          3}}, {{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 
          0}}, {{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 0}, {0, 1, 0}, {0, 
          1, 0}}, {{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}}, {{
          0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 0}, {0, 1, 0}, {0, 1, 
          0}}, {{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 0}, {0, 1, 0}, {0, 
          1, 0}}, {{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 0}, {0, 1, 0}, {
          0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0,
           1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 
          1, 0}}, {{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 0}, {1, 3, 3}, {
          1, 3, 3}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1,
           3, 3}, {0, 1, 0}}, {{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0,
           1, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0,
           1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 0}, {0, 1, 0}, {0,
           1, 0}}, {{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0,
           1, 0}, {0, 1, 0}}}, {{{72.93, 83.}, {26.633000000000003`, 
          82.977}, {-1.742, 81.805}, {0.082, 78.641}, {-0.188, 66.973}, {
          44.672000000000004`, 5.977000000000004}, {95.309, 
          2.4569999999999936`}, {223.895, -4.878999999999991}, {400.984, 
          15.824000000000012`}, {574.0619999999999, 22.507999999999996`}, {
          574.0619999999999, 74.629}, {426.60900000000004`, 75.59}, {
          191.24599999999998`, 83.055}, {72.93, 83.}}, {{79.766, 72.844}, {
          97.039, 72.844}, {107.301, 63.022999999999996`}, {
          119.85199999999999`, 72.844}, {138.23399999999998`, 72.844}, {
          134.766, 60.441}, {76.293, 60.441}}, {{162.82000000000002`, 
          72.844}, {181.42200000000003`, 72.844}, {184.08200000000002`, 
          60.441}, {152.18800000000002`, 60.441}}, {{204.531, 72.844}, {
          249.26999999999998`, 72.844}, {245.875, 60.586}, {
          196.70299999999997`, 60.586}}, {{266.84000000000003`, 72.844}, {
          300.801, 72.844}, {297.184, 60.441}, {252.961, 60.441}, {253.895, 
          63.59}, {255.617, 66.371}, {258.129, 68.781}, {260.93399999999997`, 
          71.488}, {263.83599999999996`, 72.844}, {266.84000000000003`, 
          72.844}}, {{307.96099999999996`, 72.844}, {325.754, 72.844}, {
          322.42999999999995`, 60.441}, {304.71099999999996`, 60.441}}, {{
          339.043, 72.844}, {356.83599999999996`, 72.844}, {
          353.58599999999996`, 60.441}, {335.57, 60.441}}, {{
          366.43399999999997`, 72.844}, {409.84000000000003`, 72.844}, {
          406.594, 60.441}, {358.457, 60.441}}, {{420.324, 72.844}, {465.062, 
          72.844}, {461.668, 60.586}, {412.5, 60.586}}, {{473.47999999999996`,
           72.844}, {516.891, 72.844}, {513.641, 60.441}, {465.508, 
          60.441}}, {{148.277, 55.715}, {185.11299999999997`, 55.715}, {
          192.35200000000003`, 21.976999999999997`}, {173.82000000000002`, 
          21.976999999999997`}, {168.797, 42.055}, {158.316, 42.055}, {
          143.477, 21.976999999999997`}, {105.67999999999999`, 
          21.976999999999997`}, {114.09400000000001`, 52.242000000000004`}, {
          101.617, 42.129000000000005`}, {91.281, 52.242000000000004`}, {
          82.71900000000001, 21.976999999999997`}, {65.664, 
          21.976999999999997`}, {75.039, 55.641}, {133.58200000000002`, 
          55.641}, {125.312, 26.401999999999994`}}, {{213.465, 55.641}, {
          230.148, 55.641}, {221.21499999999997`, 21.976999999999997`}, {
          204.309, 21.976999999999997`}}, CompressedData["
1:eJxTTMoPSmViYGAQBWIQLRuVYn3/boGDadwuT55L3g6djglPL3QUOGz7/PdK
xUpnh/J986X0uwscUq3v+/eGOzsobijKmNhb4HD4q0ZMP5OzA6/uprnv+wsc
Lijd/lm3yskhFmgM0/QCB82Y/kNfLZwg6pcWONhyXV9c8NbRQaj5wKmFu6Hm
HXd0mCzBEsanWgTng+WfFzq0id089/2yKcT+wgI4/yLInnv5cH7r68Adcpb5
Dhog+zIsHEDW2H7Kg8hPtnU47m3e6Xgnz0EA5E51e4j6q3kOlS/VDDnWODgs
cgX6FCj/qy5rT4mwk8PWE2X75t/Lc5hzRGFDUYSTwzeQwQ/zHLx4mLTbrzlB
/PksD+LuXmcHoC3BjwvzIepPeDsAAGmFoGg=
          "], {{303.01599999999996`, 55.641}, {352.10900000000004`, 55.641}, {
          342.953, 21.901999999999994`}, {325.09, 21.901999999999994`}, {
          330.402, 42.276999999999994`}, {317.484, 42.276999999999994`}, {
          311.801, 21.976999999999997`}, {293.71099999999996`, 
          21.976999999999997`}}, {{361.484, 55.641}, {405.043, 55.641}, {
          401.5, 42.202999999999996`}, {377.504, 42.202999999999996`}, {
          375.58599999999996`, 35.266}, {399.35900000000004`, 35.266}, {
          395.812, 21.976999999999997`}, {352.477, 21.976999999999997`}}, {{
          429.258, 55.641}, {445.941, 55.641}, {437.008, 
          21.976999999999997`}, {420.105, 21.976999999999997`}}, {{
          468.53099999999995`, 55.641}, {512.09, 55.641}, {508.547, 
          42.202999999999996`}, {484.555, 42.202999999999996`}, {482.633, 
          35.266}, {506.40599999999995`, 35.266}, {502.863, 
          21.976999999999997`}, {459.527, 21.976999999999997`}}}], 
        FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
          3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}}, {{0, 2, 0}, {1, 3, 3}, {1, 3, 
          3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}}, {{1, 4, 3}, {0, 1, 0}, {1, 3, 
          3}}, {{0, 2, 0}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}}}, {CompressedData["
1:eJxTTMoPSmViYGAQB2IQnTnxbY19WJuDtP5dFTbFYAfdTXPfL+dpc7DccqJs
n3ywQ9aekskS81odtn3+e6VCMthhmnN3znPlVgeQsmPCwQ5RKdb3/c+3Oixy
Bar4YumQATLvbquDC1DZ75OmDp8u+SYJPGmF6Ltt4uBj3umY8LbVgQEEHIwd
gLp7p/9udQCqXvlRyNBBrvV14I5JbQ4vLijd/nnP0MGO6/rigq1tEPM0TR0O
f9WI6d/b5mABNOapgZkDiLrwtM2hd3qeULOBj0PFvvlS+o/aHIpBDnEPdBCI
APoEyAfbFxAE4V9rg7ozCOK/bVD9EsEO8iD7gfaB/SMT7PB46ewjCiuh5gHD
A+xeoPtCwBLBDsBQ8DZvboOEDzD8wObnIfjo4QsARrGtpA==
          "], {{579.16, 76.383}, {579.16, 20.5}, {579.0740000000001, 
          16.801000000000002`}, {594.875, 18.64800000000001}, {597.453, 
          20.5}, {600.195, 21.851999999999997`}, {601.328, 25.914}, {
          603.4689999999999, 26.016000000000005`}, {608.6840000000001, 
          25.617000000000004`}, {613.9730000000001, 25.311999999999998`}, {
          619.348, 25.077999999999996`}, {597.5980000000001, 76.191}, {591.02,
           76.234}, {584.707, 76.289}, {579.16, 76.383}}, {{672.4219999999999,
           76.289}, {661.8119999999999, 76.227}, {650.4730000000001, 76.18}, {
          639.125, 76.148}, {661.02, 24.699000000000005`}, {671.3159999999999,
           24.891}, {682.164, 25.246000000000002`}, {693.914, 25.781}}, {{
          601.6880000000001, 76.168}, {623.496, 24.909999999999997`}, {
          634.102, 24.531}, {645.141, 24.445}, {656.977, 
          24.617000000000004`}, {635.055, 76.137}, {623.535, 76.109}, {
          612.219, 76.117}, {601.6880000000001, 76.168}}}]}, {
        FaceForm[
         RGBColor[0., 0.31764699999999996`, 0.5921569999999999, 1.]]}, 
       StripOnInput -> False]}, ImageSize -> {733., 83.}, 
     PlotRange -> {{0., 733.}, {0., 83.}}, AspectRatio -> Automatic], 
    Magnification -> 0.5, StripOnInput -> False], 
   TemplateBox[{
     InterpretationBox[
      Cell[
      "v0.3.0", Bold, FontColor -> RGBColor[0, 0.3168, 0.5928], FontSize -> 
       15, FontFamily -> "Source Code Pro"], 
      TextCell[
      "v0.3.0", Bold, FontColor -> RGBColor[0, 0.3168, 0.5928], FontSize -> 
       15, FontFamily -> "Source Code Pro"]]}, "Row", 
    DisplayFunction -> (PaneBox[#, BaselinePosition -> Scaled[0.5]]& ), 
    InterpretationFunction -> (RowBox[{"Row", "[", 
       RowBox[{
         RowBox[{"{", #, "}"}], ",", 
         RowBox[{"BaselinePosition", "\[Rule]", 
           RowBox[{"Scaled", "[", "0.5`", "]"}]}]}], "]"}]& )]},
  "RowWithSeparator"]],
 CellMargins->{{70, 5}, {5, 5}},
 GeneratedCell->True,
 CellAutoOverwrite->True,
 CellChangeTimes->{
  3.956739836118288*^9},ExpressionUUID->"95976ef0-2803-4e58-a67a-\
9916040aa530"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"by Javier Fuentes-Mart\[IAcute]n, Matthias K\[ODoubleDot]nig, \
Julie Pag\[EGrave]s, Anders Eller Thomsen, and Felix Wilsch \\n\"\>", 
   "\[InvisibleSpace]", "\<\"Reference: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{"\"arXiv:2212.04510\"", "https://arxiv.org/abs/2212.04510"},
    "HyperlinkURL"], "\[InvisibleSpace]", "\<\"\\n\"\>", 
   "\[InvisibleSpace]", "\<\"Website: \"\>", "\[InvisibleSpace]", 
   TemplateBox[{
    "\"https://gitlab.com/matchete/matchete\"", 
     "https://gitlab.com/matchete/matchete"},
    "HyperlinkURL"]}],
  SequenceForm[
  "by Javier Fuentes-Mart\[IAcute]n, Matthias K\[ODoubleDot]nig, Julie Pag\
\[EGrave]s, Anders Eller Thomsen, and Felix Wilsch \n", "Reference: ", 
   Hyperlink["arXiv:2212.04510", "https://arxiv.org/abs/2212.04510"], "\n", 
   "Website: ", 
   Hyperlink[
   "https://gitlab.com/matchete/matchete", 
    "https://gitlab.com/matchete/matchete"]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.950709023503921*^9, 3.950709047016623*^9}, 
   3.950709262564426*^9, {3.950759382922839*^9, 3.950759395364911*^9}, 
   3.950759440682909*^9, {3.950769891959468*^9, 3.950769900006513*^9}, {
   3.950770061892885*^9, 3.950770066349344*^9}, 3.950770533638825*^9, 
   3.950770718136413*^9, {3.950792659966978*^9, 3.9507926651783857`*^9}, 
   3.950798238581328*^9, 3.950802053718885*^9, 3.950803288553049*^9, 
   3.950805562047804*^9, 3.950843536953315*^9, 3.950938558621257*^9, {
   3.950953982618338*^9, 3.950954028861345*^9}, 3.950965715545906*^9, 
   3.950965819818793*^9, 3.950972009103758*^9, 3.950973250706821*^9, 
   3.950978153841634*^9, 3.956730413691312*^9, 3.956739836130776*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"e82bae42-6f0a-4dab-a0b5-4af5e1c56311"],

Cell["Set current directory:", "Text",ExpressionUUID->"79a050cd-8d2a-47da-ba41-9a81d7680968"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "@", 
   RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.950708399398726*^9, {3.950708447558883*^9, 3.950708447875107*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"39e8a43f-1efb-4e8c-9776-4fcfda57a506"],

Cell["\<\
Notice that he function EchoTiming was introduced in Mathematica version 12.2 \
only. If you are using this notebook on an older version (not recommended), \
please remove all calls of EchoTiming below.\
\>", "Text",
 CellChangeTimes->{{3.9507105246398783`*^9, 3.950710662035491*^9}, {
  3.950756454449141*^9, 
  3.95075649017764*^9}},ExpressionUUID->"bf559665-932c-455a-b7ce-\
29fa4a02661c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Loading the MSSM", "Section",ExpressionUUID->"fd2e1902-e83e-4e84-a810-3426d3596ce6"],

Cell["Loading the MSSM model file:", "Text",
 CellChangeTimes->{{3.9507088309802437`*^9, 
  3.950708834546425*^9}},ExpressionUUID->"cf08cf17-f97c-42c5-af43-\
3d29b42b0931"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[ScriptCapitalL]MSSM", " ", "=", " ", 
    RowBox[{"LoadModel", "@", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", " ", "\"\<MSSM.m\>\""}],
        "}"}], "]"}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"change", " ", 
    RowBox[{"path", "/", "name"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.950708569546761*^9, 3.95070858499577*^9}, {
  3.950709058718369*^9, 3.950709073511916*^9}, {3.950792671210507*^9, 
  3.950792672935351*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"977db4fd-231e-452b-b2f5-c24f7542a422"],

Cell[TextData[{
 "[Optional] Uncomment the line below to restrict the Lagrangian to the \
scenario of a right-handed\[LongDash]top partner plus ",
 StyleBox["bino:",
  IgnoreSpellCheck->True]
}], "Text",
 CellChangeTimes->{{3.950708737044089*^9, 3.950708739112588*^9}, {
  3.9507088396924133`*^9, 3.950708868177107*^9}, {3.950709172167962*^9, 
  3.950709193137196*^9}, {3.950756519610174*^9, 
  3.950756575857498*^9}},ExpressionUUID->"6fbd392a-ec99-4b43-9a26-\
7a6bbe3cb577"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"\[ScriptCapitalL]MSSM", " ", "=", " ", 
    RowBox[{"\[ScriptCapitalL]MSSM", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Field", "[", 
        RowBox[{
         RowBox[{"Alternatives", "[", 
          RowBox[{
          "Gt", ",", "Wt", ",", "\[CapitalSigma]", ",", "\[CapitalPhi]", ",", 
           "qt", ",", "dt", ",", "lt", ",", "et"}], "]"}], ",", "___"}], 
        "]"}], "->", "0"}], "}"}]}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.950708673305077*^9, 3.950708674955743*^9}, {
   3.95070872816285*^9, 3.950708733141*^9}, {3.950708897188571*^9, 
   3.950708986353595*^9}, 3.9507090791911297`*^9, {3.950709153086764*^9, 
   3.950709155109872*^9}, {3.950709494413223*^9, 3.950709495743025*^9}, 
   3.950770057669015*^9, 3.950770673616828*^9, {3.950770704373432*^9, 
   3.950770711144481*^9}, 3.950771544803211*^9, {3.9507726858612823`*^9, 
   3.950772695232544*^9}, {3.950965682002393*^9, 3.950965707317195*^9}, {
   3.950965801633842*^9, 3.9509658225611153`*^9}, {3.95097198869256*^9, 
   3.9509719976204357`*^9}, {3.950973225287575*^9, 3.950973243888639*^9}, {
   3.9509781371411133`*^9, 3.950978147202127*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"a0c51fe8-766a-4872-b516-69d57e6251a6"],

Cell["Print the resulting Lagrangian:", "Text",
 CellChangeTimes->{{3.950708883028817*^9, 3.950708887830059*^9}, {
  3.950756566729052*^9, 
  3.950756568321486*^9}},ExpressionUUID->"a55ed50d-a19c-4d35-8e95-\
30ca74f03203"],

Cell[BoxData[
 RowBox[{"NiceForm", "[", 
  RowBox[{"\[ScriptCapitalL]MSSM", "//", "HcSimplify"}], "]"}]], "Input",
 CellChangeTimes->{{3.950709115497577*^9, 3.9507091174766808`*^9}, {
  3.95070916128931*^9, 3.950709161562918*^9}, {3.950756999345113*^9, 
  3.950757017993719*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"47b7e321-6ecf-4830-830b-9b21e2a38a43"],

Cell["\<\
Note: For illustration and better performance, the matching and operator \
reduction to the Warsaw basis is divided into several part below. 
The compact code to perform everything at once can be found at the end of \
this notebook.\
\>", "Text",
 CellChangeTimes->{{3.95075660348979*^9, 
  3.950756692074267*^9}},ExpressionUUID->"7fcf22f6-b5d9-4252-9764-\
17db7c1e064d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tree-level matching", "Section",ExpressionUUID->"5be8d12c-5d56-418b-8ca1-8a69515e73b6"],

Cell["\<\
Calculating the tree-level matching result separately simplifies the proper \
treatment of evanescent operators.
Tree-level generated evanescent operators affect observables only starting at \
the one-loop level. In turn, one-loop generated evanescent operators only \
affect two-loop matching calculations, and are therefore neglected here.\
\>", "Text",
 CellChangeTimes->{{3.950709236417736*^9, 3.950709241305039*^9}, {
  3.950756710411788*^9, 
  3.9507567967684593`*^9}},ExpressionUUID->"bb14a0be-dc97-447d-8ede-\
aefbca38d859"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[ScriptCapitalL]0", "=", 
   RowBox[{"GreensSimplify", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Match", "[", 
      RowBox[{"\[ScriptCapitalL]MSSM", ",", "\[IndentingNewLine]", 
       RowBox[{"EFTOrder", "->", "6"}], ",", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"matching", " ", "at", " ", "d"}], "=", "6"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"LoopOrder", "->", "0"}]}], "  ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"matching", " ", "at", " ", "tree"}], "-", "level"}], " ", 
       "*)"}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"ReductionIdentities", "->", "dDimensional"}]}], " ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"apply", " ", "only", " ", "off"}], "-", 
       RowBox[{
       "shell", " ", "simplification", " ", "identities", " ", "that", " ", 
        "are", " ", "exact", " ", "in", " ", "D"}]}], "=", 
      RowBox[{"4", "-", 
       RowBox[{"2", "\[Epsilon]", " ", "space"}], "-", 
       RowBox[{"time", " ", "dimensions"}]}]}], "*)"}], "\[IndentingNewLine]",
     "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.950709214271964*^9, 3.9507092155228558`*^9}, {
  3.950709246843227*^9, 3.950709290176526*^9}, {3.9507568027996693`*^9, 
  3.950756972673721*^9}, {3.9507590368400173`*^9, 3.950759037338502*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"2a5215fa-8b8b-4aca-a0d7-783ac1ef2c4b"],

Cell["Print tree-level EFT Lagrangian:", "Text",
 CellChangeTimes->{{3.9507095043827467`*^9, 3.950709513291924*^9}, 
   3.950757026453233*^9},ExpressionUUID->"386e470c-77b6-48de-8064-\
9fa465b0cfd0"],

Cell[BoxData[
 RowBox[{"\[ScriptCapitalL]0", "//", "NiceForm"}]], "Input",
 CellChangeTimes->{{3.950709288289757*^9, 3.9507092985658293`*^9}, 
   3.950709487732128*^9, {3.950710110682426*^9, 3.950710112421234*^9}, {
   3.950759038412619*^9, 3.950759038800604*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"67bc243c-a9fd-4fa9-8067-203de4761b94"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Evanescent operators from applying Fierz identities", "Section",
 CellChangeTimes->{{3.950709394819067*^9, 
  3.950709445339526*^9}},ExpressionUUID->"fb4a8354-c405-44e4-8ce2-\
723fc21e2cc8"],

Cell[TextData[{
 "Apply Fierz identities to tree-level EFT Lagrangian to map to the Warsaw \
basis.\[LineSeparator]Since Fierz identities are intrinsically four \
dimensional, this introduces evanescent operators when working in dimensional \
regularization (D=4-2\[Epsilon]).\[LineSeparator]We employ an evanescent-free \
version of the ",
 Cell[BoxData[
  FormBox[
   OverscriptBox["MS", "_"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "a50782d4-5798-4887-858f-d7eb9c97778b"],
 " renormalization scheme, where the evanescent operators can be neglected \
and their effect is absorb by redefining the Wilson coefficients of the \
physical operators.\[LineSeparator]The necessary shifts of the physical \
operator coefficients are automatically computed below.\nFor more details see \
[",
 ButtonBox["2211.09144",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://arxiv.org/abs/2211.09144"], None},
  ButtonNote->"https://arxiv.org/abs/2211.09144"],
 "]."
}], "Text",
 CellChangeTimes->{{3.950709518499206*^9, 3.950709858935859*^9}, {
  3.950757049245133*^9, 
  3.950757085652836*^9}},ExpressionUUID->"bf6979ca-3a55-44f6-86a4-\
20f37aa818f3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[ScriptCapitalL]TreeLevel", "=", " ", 
   RowBox[{"GreensSimplify", "[", 
    RowBox[{"\[ScriptCapitalL]0", ",", "\[IndentingNewLine]", 
     RowBox[{"ReductionIdentities", "->", "EvanescenceFree"}]}], " ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"apply", " ", "also", " ", "intrinsically", " ", "D"}], "=", 
      RowBox[{
       RowBox[{
       "4", " ", "identities", " ", "and", " ", "shift", " ", "to", " ", 
        "evanescent"}], "-", 
       RowBox[{
       "free", " ", "scheme", " ", "to", " ", "remove", " ", "the", " ", 
        "resulting", " ", "evanescent", " ", "operators"}]}]}], " ", "*)"}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.950709329104269*^9, 3.950709368135617*^9}, {
  3.950757097555214*^9, 3.950757164825787*^9}, {3.950759042262005*^9, 
  3.950759070454458*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"e94f9306-290f-48e0-9f5e-d8f7ea09ff9e"],

Cell["Print the evanescent shifts just computed:", "Text",
 CellChangeTimes->{{3.95070987684836*^9, 3.950709893813147*^9}, {
  3.950757172052143*^9, 3.950757178505618*^9}, {3.9567304386882153`*^9, 
  3.956730441103746*^9}},ExpressionUUID->"74d801c8-00ef-4ee4-ae16-\
4973ca08b855"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"CollectOperators", "[", 
    RowBox[{"\[ScriptCapitalL]EFT$TreeLevel", "-", "\[ScriptCapitalL]EFT0"}], 
    "]"}], "//", "NiceForm"}], "*)"}]], "Input",
 CellChangeTimes->{{3.950709452748322*^9, 3.950709480926687*^9}, {
  3.950843553060279*^9, 3.95084355904246*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"85c60f17-7ca0-496e-ae59-cd75e7bbfedf"]
}, Open  ]],

Cell[CellGroupData[{

Cell["One-loop matching the full MSSM", "Section",ExpressionUUID->"9a1d407a-f695-4de7-86f4-d46a6c2fe165"],

Cell["\<\
Perform the one-loop matching, excluding the tree-level results that were \
computed above.
Depending on the available computing power, this takes several minutes to \
hours!\
\>", "Text",
 CellChangeTimes->{{3.950710026510436*^9, 
  3.95071006254381*^9}},ExpressionUUID->"095e969a-bc12-424d-be34-\
0ef6efaf16c4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[ScriptCapitalL]1", "=", " ", 
   RowBox[{"EchoTiming", "@", " ", 
    RowBox[{"Match", "[", 
     RowBox[{"\[ScriptCapitalL]MSSM", ",", "\[IndentingNewLine]", 
      RowBox[{"EFTOrder", "->", "6"}], ",", "\[IndentingNewLine]", 
      RowBox[{"LoopOrder", "->", 
       RowBox[{"{", "1", "}"}]}]}], " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"compute", " ", "exclusively", " ", "the", " ", "one"}], "-", 
       RowBox[{"loop", " ", "matching", " ", 
        RowBox[{"w", "/", "o"}], " ", "tree"}], "-", 
       RowBox[{"level", " ", "contributions"}]}], "*)"}], 
     "\[IndentingNewLine]", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.950709918432864*^9, 3.950709943182083*^9}, {
  3.9507571922111187`*^9, 3.950757249025173*^9}, {3.950759047481205*^9, 
  3.950759047978494*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"08615ce0-de31-4cfd-9de5-dd32b59afd15"],

Cell["\<\
!!! Do not try to print the resulting expression using NiceForm as this might \
freeze the front end of Mathematica due to the size of the expression. !!!\
\>", "Text",
 CellChangeTimes->{{3.950709956200345*^9, 3.950709989652193*^9}, {
  3.950710126192643*^9, 3.950710134188971*^9}, {3.95071179590921*^9, 
  3.9507118167733936`*^9}, {3.95075726239097*^9, 
  3.9507572692288733`*^9}},ExpressionUUID->"f7325c77-ae1d-4f03-ba38-\
f511696e83d5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[ScriptCapitalL]1", "//", "ByteCount"}]], "Input",
 CellChangeTimes->{{3.950709994213188*^9, 3.950710000201851*^9}, {
  3.950757288794209*^9, 3.950757290715395*^9}, {3.950759049146585*^9, 
  3.950759049505262*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"5ada658e-db36-448e-bd82-ba65217780a4"],

Cell[BoxData["127270608"], "Output",
 CellChangeTimes->{3.956731249327632*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"79eb181a-6653-4bc0-b1c9-cbf5e007810f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Simplifying the EFT Lagrangian", "Section",ExpressionUUID->"6def308c-5232-4179-b13b-c71eaf2c9ae2"],

Cell[CellGroupData[{

Cell["Off-Shell Simplifications", "Subsection",
 CellChangeTimes->{{3.9507101414940643`*^9, 3.950710149478405*^9}, {
  3.9507103535683737`*^9, 
  3.950710353943262*^9}},ExpressionUUID->"332e9b3e-aa5a-47ca-9dee-\
125b082ed9c8"],

Cell["\<\
For the one-loop results we can simply apply the four-dimensional Fierz \
identities, since the evanescent operators generated by this are of two-loop \
order and can be neglected.\
\>", "Text",
 CellChangeTimes->{{3.950710161625903*^9, 
  3.950710161955683*^9}},ExpressionUUID->"3a26e6b1-885b-47d3-af16-\
e7d00f6a1791"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[ScriptCapitalL]OneLoop", "=", 
   RowBox[{"EchoTiming", "@", 
    RowBox[{"GreensSimplify", "[", 
     RowBox[{"\[ScriptCapitalL]1", ",", "\[IndentingNewLine]", 
      RowBox[{"ReductionIdentities", "->", "FourDimensional"}]}], " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"apply", " ", "intrinsically", " ", "D"}], "=", 
       RowBox[{"4", " ", "identities", " ", 
        RowBox[{"w", "/", "o"}], " ", "accounting", " ", "for", " ", 
        "evanescent", " ", "operators"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9507101659640303`*^9, 3.950710192782914*^9}, 
   3.9507107783218412`*^9, {3.950757320309209*^9, 3.950757354237213*^9}, {
   3.95075905227393*^9, 3.950759068407743*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"d74bc32d-6b25-4856-93d4-45dbf638b70b"],

Cell["\<\
Combine tree-level and one-loop results, giving the full EFT Lagrangian:\
\>", "Text",
 CellChangeTimes->{{3.950757364361224*^9, 
  3.9507573647712793`*^9}},ExpressionUUID->"a4da76df-3d5f-4822-b496-\
f8e32d60edb1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[ScriptCapitalL]Full", "=", 
   RowBox[{"\[ScriptCapitalL]TreeLevel", "+", "\[ScriptCapitalL]OneLoop"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.950710772968876*^9, 3.950710775457192*^9}, {
  3.950759000821391*^9, 3.950759001402913*^9}, {3.950759055919368*^9, 
  3.950759067282273*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"49378201-d041-497b-ab66-b5632f541d49"]
}, Open  ]],

Cell[CellGroupData[{

Cell["On-Shell Simplifications", "Subsection",
 CellChangeTimes->{{3.950710359329467*^9, 
  3.9507103594487543`*^9}},ExpressionUUID->"b4c35bc8-8ad6-4764-9928-\
07fc702caa09"],

Cell["\<\
Apply the necessary field redefinitions to map to an on-shell basis.\
\>", "Text",ExpressionUUID->"db2f2751-3940-4967-a312-8d629d65a877"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[ScriptCapitalL]OnShell", "=", " ", 
   RowBox[{"EchoTiming", "@", 
    RowBox[{"EOMSimplify", "[", 
     RowBox[{"\[ScriptCapitalL]Full", ",", "\[IndentingNewLine]", 
      RowBox[{"ReductionIdentities", "->", "dDimensional"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.950710376220517*^9, 3.950710379490395*^9}, {
   3.950757411100823*^9, 3.950757479919907*^9}, {3.950759082300988*^9, 
   3.950759084812636*^9}, 3.950967486168356*^9, 3.9509706275873413`*^9, {
   3.950971493535679*^9, 3.9509714940683928`*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"487948c1-3000-4207-b554-0d2d4786a266"],

Cell["\<\
The field redefinitions can introduce operators that require Fierz identities \
to be mapped onto the Warsaw basis.
These are, however, already of one-loop order and thus do not generate \
evanescent operators at this order, thus using the FourDimensional and \
EvanescentFree options for ReductionIdentities yields identical results.\
\>", "Text",
 CellChangeTimes->{{3.950710449231894*^9, 3.950710489522009*^9}, {
  3.950710713532755*^9, 
  3.950710748440854*^9}},ExpressionUUID->"6d9a5f51-4995-4310-bf37-\
048291157307"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[ScriptCapitalL]OnShell", "=", " ", 
   RowBox[{"EchoTiming", "@", 
    RowBox[{"GreensSimplify", "[", "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalL]OnShell", ",", "\[IndentingNewLine]", 
      RowBox[{"ReductionIdentities", "->", "EvanescenceFree"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.950710496229179*^9, 3.950710502348716*^9}, {
  3.950710753480839*^9, 3.950710757771076*^9}, {3.9507575090492573`*^9, 
  3.950757513042171*^9}, {3.950759105559708*^9, 3.950759109991285*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"88d4a77a-bb7b-4c76-a67a-ea89c8c9f1f4"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Mapping to the Warsaw basis", "Section",
 CellChangeTimes->{{3.9507108221852837`*^9, 
  3.9507108225300217`*^9}},ExpressionUUID->"8605de96-e1a3-4e53-9a11-\
5e067f6f42d0"],

Cell[TextData[{
 "In this section the MSSM one-loop matching results are mapped onto the \
Warsaw basis [",
 ButtonBox["1008.4884",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://arxiv.org/abs/1008.4884"], None},
  ButtonNote->"https://arxiv.org/abs/1008.4884"],
 "].\nThis is necessary, since the minimal on-shell basis used by Matchete \
above does not agree with the Warsaw basis."
}], "Text",
 CellChangeTimes->{{3.950710831771027*^9, 3.950710867068186*^9}, {
  3.950711563305339*^9, 3.950711564065982*^9}, {3.950757527058096*^9, 
  3.9507575583340683`*^9}},ExpressionUUID->"b2ed6d60-aa53-4c86-a985-\
8a782b264825"],

Cell[TextData[{
 "When loading the SMEFT Lagrangian in the Warsaw basis, the names of the \
gauge couplings have to be chosen consistently w.r.t. the names chosen in the \
MSSM model file.\nFurthermore, we redefine the electroweak scale parameter in \
the SMEFT as minus the Higgs doublet mass parameter ",
 Cell[BoxData[
  RowBox[{
   SuperscriptBox["\[Mu]", "2"], "->", 
   RowBox[{"-", 
    SubsuperscriptBox["M", "H", "2"]}]}]], "Input",
  CellChangeTimes->{{3.950755635551649*^9, 3.950755739116843*^9}, {
   3.950755775004932*^9, 3.9507557863118887`*^9}, {3.9507560174032803`*^9, 
   3.950756046113858*^9}, {3.950756077297368*^9, 3.950756167883511*^9}, {
   3.950756225169269*^9, 3.950756260506772*^9}},ExpressionUUID->
  "8f34b10b-a920-4e68-a508-743fc11b3dd8"],
 ". "
}], "Text",
 CellChangeTimes->{{3.950711598357108*^9, 3.95071163070051*^9}, {
  3.950711742009366*^9, 3.9507117550590973`*^9}, {3.950756291771287*^9, 
  3.950756366856732*^9}, {3.950757589253396*^9, 
  3.950757601650185*^9}},ExpressionUUID->"14ed9cc6-f968-4fc9-8017-\
a8ac224078e4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[ScriptCapitalL]Warsaw", "=", 
   RowBox[{
    RowBox[{"LoadModel", "[", 
     RowBox[{"\"\<SMEFT\>\"", ",", "\[IndentingNewLine]", 
      RowBox[{"ModelParameters", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"gs", "->", "g3"}], ",", 
         RowBox[{"gL", "->", "g2"}], ",", 
         RowBox[{"gY", "->", "g1"}], ",", 
         RowBox[{"\[Mu]2", "->", "MH2"}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"SetModelOptions", "->", 
       RowBox[{"{", 
        RowBox[{"(*", " ", 
         RowBox[{
         "NiceForm", " ", "must", " ", "be", " ", "chosen", " ", 
          "consistently", " ", 
          RowBox[{"w", ".", "r", ".", "t", ".", " ", "NiceForm"}], " ", "of", 
          " ", "MSSM", " ", "gauge", " ", "couplings"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"DefineGaugeGroup", ",", "SU3c", ",", 
           RowBox[{"NiceForm", "->", 
            RowBox[{"{", 
             RowBox[{
             "\"\<\\!\\(\\*SubscriptBox[\\(g\\), \\(3\\)]\\)\>\"", ",", 
              "Default"}], "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"DefineGaugeGroup", ",", "SU2L", ",", 
           RowBox[{"NiceForm", "->", 
            RowBox[{"{", 
             RowBox[{
             "\"\<\\!\\(\\*SubscriptBox[\\(g\\), \\(2\\)]\\)\>\"", ",", 
              "Default"}], "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"DefineGaugeGroup", ",", "U1Y", ",", 
           RowBox[{"NiceForm", "->", 
            RowBox[{"{", 
             RowBox[{
             "\"\<\\!\\(\\*SubscriptBox[\\(g\\), \\(1\\)]\\)\>\"", ",", 
              "Default"}], "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"DefineCoupling", ",", "MH2", ",", 
           RowBox[{
           "NiceForm", "->", 
            "\"\<\!\(\*TagBox[SubsuperscriptBox[\"M\", \"H\", \
\"2\"],DisplayForm]\)\>\""}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}]}], 
     "\[IndentingNewLine]", "]"}], "/.", 
    RowBox[{
     RowBox[{"MH2", "[", "]"}], "->", 
     RowBox[{"-", 
      RowBox[{"MH2", "[", "]"}]}]}]}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "flip", " ", "sign", " ", "of", " ", "the", " ", "Higgs", " ", "mass"}], 
   " ", "*)"}], ";"}]], "Input",
 CellChangeTimes->{{3.95071163298987*^9, 3.950711633357929*^9}, {
   3.950712380650206*^9, 3.950712387609534*^9}, {3.950756371355084*^9, 
   3.95075641074653*^9}, {3.950757690487178*^9, 3.950757780301071*^9}, {
   3.950757916076579*^9, 3.95075792466261*^9}, 3.950759131077935*^9, {
   3.95075926571319*^9, 3.950759279099696*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"5c4d3239-331a-4f09-8122-eb6946130f48"],

Cell["\<\
Remove all Baryon-number-violating terms which are not generated in the \
R-parity conserving MSSM, since these can currently still cause issues with \
MapEffectiveCouplings.\
\>", "Text",
 CellChangeTimes->{{3.95071124711939*^9, 3.950711269617975*^9}, 
   3.95071195539872*^9, {3.950763613596453*^9, 
   3.950763657041662*^9}},ExpressionUUID->"e91a6b1f-52e2-468b-8f3c-\
dcd69829ff2b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[ScriptCapitalL]Warsaw", "=", 
   RowBox[{"\[ScriptCapitalL]Warsaw", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Coupling", "[", 
       RowBox[{
        RowBox[{"cllHH", "|", "cduu", "|", "cqqq", "|", "cqqu", "|", "cduq"}],
         ",", "___"}], "]"}], "->", "0"}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.950758227788801*^9, {3.950759317757413*^9, 3.95075931874772*^9}, {
   3.950763595256471*^9, 3.950763598726835*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"6f6cbef8-855d-4a8d-89f2-2ece457c78d6"],

Cell[TextData[{
 "The Warsaw basis needs to be mapped to the on-shell basis used internally \
by Matchete. \nThe latter disagrees from the former for two operators:\n(i) \
Matchete rewrites ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["Q", 
    RowBox[{"H", "\[Square]"}]], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "0e4bc6e7-ff59-4312-8ad7-f38df67dbbde"],
 " in the Warsaw basis by applying field redefinitions;\[LineSeparator](ii) \
Matchete also applies a Fierz identity to ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["Q", "lequ", 
    RowBox[{"(", "3", ")"}]], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "e9af5199-4069-4a71-a3bf-390f13d590a8"],
 ", producing a four-fermion operator with a leptoquark-like structure.\nThe \
latter does not contain a Lorentz tensor structure ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Sigma]", "\[Mu]\[Nu]"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "f3923b1f-212e-47c2-8f7f-b2704484d7d1"],
 ", which is favorable since ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Sigma]", "\[Mu]\[Nu]"], TraditionalForm]],ExpressionUUID->
  "6e34f1af-16ca-439f-8bd9-2bf719d88289"],
 " can lead to reading-point ambiguities in NDR. (See again [",
 ButtonBox["2211.09144",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://arxiv.org/abs/2211.09144"], None},
  ButtonNote->"https://arxiv.org/abs/2211.09144"],
 "] for more details.)\nUsing FourDimensional or EvanescentFree for the \
ReductionIdentities option yields equivalent results here, since the only \
evanescent operator potentially generated originates from applying the Fierz \
identity to ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["Q", "lequ", 
    RowBox[{"(", "3", ")"}]], TraditionalForm]],ExpressionUUID->
  "3ed406a7-db3e-43af-89b7-d4abba3b97b9"],
 ", which is however entirely loop generated in the MSSM."
}], "Text",
 CellChangeTimes->{{3.950710910873816*^9, 3.950710966287053*^9}, {
  3.950711083161158*^9, 3.950711142567532*^9}, {3.950711322676195*^9, 
  3.9507115477613792`*^9}, {3.950711589856228*^9, 3.950711597395114*^9}, {
  3.950711646389757*^9, 3.950711690391169*^9}, {3.950711720752677*^9, 
  3.9507117771859417`*^9}, {3.950711857335137*^9, 3.95071194669823*^9}, {
  3.950757938119713*^9, 
  3.9507582078990383`*^9}},ExpressionUUID->"6cac5f9f-b846-4f6e-b4b9-\
780296c9d1d0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[ScriptCapitalL]WarsawMatchete", "=", 
   RowBox[{"EchoTiming", "@", 
    RowBox[{"EOMSimplify", "[", "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalL]Warsaw", ",", "\[IndentingNewLine]", 
      RowBox[{"ReductionIdentities", "->", "FourDimensional"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.950710973443383*^9, 3.950710976877499*^9}, {
   3.950711011587729*^9, 3.950711081167126*^9}, {3.950711150172453*^9, 
   3.95071121414742*^9}, 3.950711610568717*^9, {3.950711779953725*^9, 
   3.950711780245579*^9}, {3.950711841588673*^9, 3.950711844335915*^9}, 
   3.95071239287912*^9, {3.950758212733725*^9, 3.950758219730714*^9}, 
   3.950759138679549*^9, {3.950759302706769*^9, 3.95075931336836*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"0c4fb030-f9f3-4584-96ec-37ea671659c9"],

Cell[CellGroupData[{

Cell["Determine the matching conditions in the Warsaw basis.", "Subsection",ExpressionUUID->"7374b566-51c7-485c-93f3-f7d499ac58ec"],

Cell["\<\
The following can improve the performance for this specific case, but is not \
strictly necessary.\
\>", "Text",
 CellChangeTimes->{{3.95071204275392*^9, 
  3.9507120866012383`*^9}},ExpressionUUID->"0eecea16-515d-44ff-846e-\
58dbe13fee17"],

Cell["\<\
Map the Lagrangian obtained from matching the MSSM to the Lagrangian of the \
Warsaw basis.\
\>", "Text",
 CellChangeTimes->{{3.950758331245627*^9, 
  3.950758354915819*^9}},ExpressionUUID->"94efd16e-c013-4f79-8c62-\
383ccfc89a45"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MatchingCondition", "=", 
   RowBox[{"EchoTiming", "@", 
    RowBox[{"MapEffectiveCouplings", "[", 
     RowBox[{
     "\[ScriptCapitalL]OnShell", ",", "\[ScriptCapitalL]WarsawMatchete", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"EOMSimplify", "->", "False"}], ",", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "application", " ", "of", " ", "field", " ", "redefinitions", " ", 
         "not", " ", "required", " ", "here"}], ",", " ", 
        RowBox[{
         RowBox[{
         "as", " ", "both", " ", "the", " ", "matching", " ", "and", " ", 
          "the", " ", "Warsaw", " ", "basis", " ", "Lagrangian", " ", "haven",
           " ", "be", " ", "brought", " ", "to", " ", "the", " ", "same", " ",
           "minimal", " ", "on"}], "-", 
         RowBox[{"shell", " ", "form", " ", 
          RowBox[{"before", "."}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"ReductionIdentities", "->", "dDimensional"}], ",", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "no", " ", "Fierz", " ", "identites", " ", "required", " ", "here", 
        " ", "for", " ", "mapping", " ", "between", " ", "the", " ", "two", 
        " ", "Lagrangians"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"ShiftRenCouplings", "->", "False"}], 
      RowBox[{"(*", "True", "*)"}], " ", ",", 
      RowBox[{"(*", " ", 
       RowBox[{
       "see", " ", "Appendix", " ", "D", ".2", " ", "of", " ", "the", " ", 
        "associated", " ", "paper", " ", "for", " ", "a", " ", "description", 
        " ", "of", " ", "this", " ", "option"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"AppendEffectiveCouplingsDefs", "->", "True"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.950712101586629*^9, 3.950712247879385*^9}, {
   3.950758360202331*^9, 3.9507585159286737`*^9}, 3.950759323407481*^9, 
   3.950759360309771*^9, 3.950763569092924*^9, {3.950969592177978*^9, 
   3.950969599056613*^9}, {3.95105484389794*^9, 3.95105484825517*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"e0306241-b024-45d8-995c-46e936437869"],

Cell["Remove divergences by renormalization", "Text",
 CellChangeTimes->{{3.9567334771646843`*^9, 
  3.956733509642899*^9}},ExpressionUUID->"0ece89d0-e39c-4068-9c31-\
cfdc39dd2314"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MatchingConditionFinite", "=", 
   RowBox[{"MatchingCondition", "/.", 
    RowBox[{
     FractionBox["1", "\[Epsilon]"], "->", "0"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.956733459808338*^9, 3.9567334908462276`*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"058c868c-a8b4-4510-859a-2382e5fc7727"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compact alternative", "Section",
 CellChangeTimes->{{3.950712260040834*^9, 3.950712270885457*^9}, 
   3.950758593532936*^9},ExpressionUUID->"0ebb6802-ac6b-450b-b488-\
dc56bfd34a3f"],

Cell["\<\
The above codes gives a step-by-step description of the functions used inside \
the code. 
The entire matching can also be performed in a more compact manner using:\
\>", "Text",
 CellChangeTimes->{{3.9507122755216928`*^9, 3.950712343237015*^9}, {
  3.950712491209273*^9, 
  3.950712494569003*^9}},ExpressionUUID->"89e826e3-e4dc-4e1b-807b-\
4120eb117b2e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[ScriptCapitalL]match", "=", 
   RowBox[{"EchoTiming", "@", 
    RowBox[{"Match", "[", 
     RowBox[{"\[ScriptCapitalL]MSSM", ",", "\[IndentingNewLine]", 
      RowBox[{"EFTOrder", "->", "6"}], ",", "\[IndentingNewLine]", 
      RowBox[{"LoopOrder", "->", "1"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.950712351307383*^9, 3.950712371439701*^9}, {
  3.950712452684945*^9, 3.950712454799845*^9}, {3.950758543607189*^9, 
  3.950758547969054*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"fa9ab662-591c-49b0-84a2-1cd92270e6c5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mc", "=", 
   RowBox[{"EchoTiming", "@", 
    RowBox[{"MapEffectiveCouplings", "[", 
     RowBox[{
     "\[ScriptCapitalL]match", ",", "\[ScriptCapitalL]Warsaw", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"EOMSimplify", "->", "True"}], ",", "\[IndentingNewLine]", 
      RowBox[{"ReductionIdentities", "->", "EvanescenceFree"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ShiftRenCouplings", "->", "False"}], 
      RowBox[{"(*", "True", "*)"}], ",", "\[IndentingNewLine]", 
      RowBox[{"AppendEffectiveCouplingsDefs", "->", "True"}]}], "\n", 
     "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.95071239725664*^9, 3.9507124604100103`*^9}, {
   3.950758561686558*^9, 3.9507585726746283`*^9}, 3.950759374438541*^9, {
   3.950965760293343*^9, 3.950965762930799*^9}, 3.950970167103681*^9, {
   3.950972053891464*^9, 3.950972055849587*^9}, {3.951054835012788*^9, 
   3.951054865391966*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"35112bfb-1235-4620-ba54-790112fdb5e6"],

Cell["\<\
Performance can be worse in this case, since the set of reduction identities \
applied at various states might be larger than required for specific steps.
However, notice that Matchete caches certain results during the computation, \
making the second evaluation of an expression faster in some cases.\
\>", "Text",
 CellChangeTimes->{{3.950712472411449*^9, 3.950712664297348*^9}, {
  3.950758589373294*^9, 
  3.950758674847582*^9}},ExpressionUUID->"5d200428-c6ed-4781-95f9-\
07af6c8f6707"],

Cell["Remove divergences by renormalization", "Text",
 CellChangeTimes->{{3.9567334771646843`*^9, 
  3.956733509642899*^9}},ExpressionUUID->"e6d4c3cd-a70c-467b-bbbf-\
041a1e761b85"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mcFinite", "=", 
   RowBox[{"mc", "/.", 
    RowBox[{
     FractionBox["1", "\[Epsilon]"], "->", "0"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.956733459808338*^9, 3.956733490846227*^9}, {
  3.956743130555572*^9, 3.956743131608128*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"30a32762-c7a0-446e-b532-4d8bb51766d4"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1147, 1387},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"14.0 for Mac OS X ARM (64-bit) (December 12, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"da9a17d9-2d55-4a9e-adfc-21d734b38e2a"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 112, 0, 123, "Title",ExpressionUUID->"8d0e942e-f42f-46c2-a346-91d4d9eef4e9"],
Cell[695, 24, 533, 11, 148, "Subtitle",ExpressionUUID->"7dc2047a-b130-4bef-ac0f-9e9bac102269"],
Cell[CellGroupData[{
Cell[1253, 39, 161, 3, 84, "Section",ExpressionUUID->"f2c594f8-f2e1-4d7c-b35e-abcc6d951b3b"],
Cell[1417, 44, 252, 4, 37, "Input",ExpressionUUID->"862068ec-e0dd-4bfd-8dd7-9edc23e74121"],
Cell[1672, 50, 8124, 129, 56, InheritFromParent,ExpressionUUID->"95976ef0-2803-4e58-a67a-9916040aa530"],
Cell[9799, 181, 1793, 33, 81, "Print",ExpressionUUID->"e82bae42-6f0a-4dab-a0b5-4af5e1c56311"],
Cell[11595, 216, 93, 0, 44, "Text",ExpressionUUID->"79a050cd-8d2a-47da-ba41-9a81d7680968"],
Cell[11691, 218, 287, 6, 37, "Input",ExpressionUUID->"39e8a43f-1efb-4e8c-9776-4fcfda57a506"],
Cell[11981, 226, 402, 8, 73, "Text",ExpressionUUID->"bf559665-932c-455a-b7ce-29fa4a02661c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12420, 239, 90, 0, 84, "Section",ExpressionUUID->"fd2e1902-e83e-4e84-a810-3426d3596ce6"],
Cell[12513, 241, 172, 3, 44, "Text",ExpressionUUID->"cf08cf17-f97c-42c5-af43-3d29b42b0931"],
Cell[12688, 246, 658, 16, 37, "Input",ExpressionUUID->"977db4fd-231e-452b-b2f5-c24f7542a422"],
Cell[13349, 264, 475, 10, 44, "Text",ExpressionUUID->"6fbd392a-ec99-4b43-9a26-7a6bbe3cb577"],
Cell[13827, 276, 1271, 24, 37, "Input",ExpressionUUID->"a0c51fe8-766a-4872-b516-69d57e6251a6"],
Cell[15101, 302, 222, 4, 44, "Text",ExpressionUUID->"a55ed50d-a19c-4d35-8e95-30ca74f03203"],
Cell[15326, 308, 357, 6, 37, "Input",ExpressionUUID->"47b7e321-6ecf-4830-830b-9b21e2a38a43"],
Cell[15686, 316, 381, 8, 102, "Text",ExpressionUUID->"7fcf22f6-b5d9-4252-9764-17db7c1e064d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16104, 329, 93, 0, 84, "Section",ExpressionUUID->"5be8d12c-5d56-418b-8ca1-8a69515e73b6"],
Cell[16200, 331, 542, 10, 102, "Text",ExpressionUUID->"bb14a0be-dc97-447d-8ede-aefbca38d859"],
Cell[16745, 343, 1490, 32, 246, "Input",ExpressionUUID->"2a5215fa-8b8b-4aca-a0d7-783ac1ef2c4b"],
Cell[18238, 377, 199, 3, 44, "Text",ExpressionUUID->"386e470c-77b6-48de-8064-9fa465b0cfd0"],
Cell[18440, 382, 342, 5, 37, "Input",ExpressionUUID->"67bc243c-a9fd-4fa9-8067-203de4761b94"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18819, 392, 196, 3, 84, "Section",ExpressionUUID->"fb4a8354-c405-44e4-8ce2-723fc21e2cc8"],
Cell[19018, 397, 1176, 26, 217, "Text",ExpressionUUID->"bf6979ca-3a55-44f6-86a4-20f37aa818f3"],
Cell[20197, 425, 955, 20, 142, "Input",ExpressionUUID->"e94f9306-290f-48e0-9f5e-d8f7ea09ff9e"],
Cell[21155, 447, 280, 4, 44, "Text",ExpressionUUID->"74d801c8-00ef-4ee4-ae16-4973ca08b855"],
Cell[21438, 453, 397, 8, 37, "Input",ExpressionUUID->"85c60f17-7ca0-496e-ae59-cd75e7bbfedf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21872, 466, 105, 0, 84, "Section",ExpressionUUID->"9a1d407a-f695-4de7-86f4-d46a6c2fe165"],
Cell[21980, 468, 323, 8, 73, "Text",ExpressionUUID->"095e969a-bc12-424d-be34-0ef6efaf16c4"],
Cell[22306, 478, 917, 19, 116, "Input",ExpressionUUID->"08615ce0-de31-4cfd-9de5-dd32b59afd15"],
Cell[23226, 499, 450, 8, 73, "Text",ExpressionUUID->"f7325c77-ae1d-4f03-ba38-f511696e83d5"],
Cell[CellGroupData[{
Cell[23701, 511, 317, 5, 37, "Input",ExpressionUUID->"5ada658e-db36-448e-bd82-ba65217780a4"],
Cell[24021, 518, 156, 2, 42, "Output",ExpressionUUID->"79eb181a-6653-4bc0-b1c9-cbf5e007810f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[24226, 526, 104, 0, 84, "Section",ExpressionUUID->"6def308c-5232-4179-b13b-c71eaf2c9ae2"],
Cell[CellGroupData[{
Cell[24355, 530, 226, 4, 67, "Subsection",ExpressionUUID->"332e9b3e-aa5a-47ca-9dee-125b082ed9c8"],
Cell[24584, 536, 330, 7, 73, "Text",ExpressionUUID->"3a26e6b1-885b-47d3-af16-e7d00f6a1791"],
Cell[24917, 545, 873, 17, 116, "Input",ExpressionUUID->"d74bc32d-6b25-4856-93d4-45dbf638b70b"],
Cell[25793, 564, 224, 5, 44, "Text",ExpressionUUID->"a4da76df-3d5f-4822-b496-f8e32d60edb1"],
Cell[26020, 571, 405, 8, 37, "Input",ExpressionUUID->"49378201-d041-497b-ab66-b5632f541d49"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26462, 584, 174, 3, 67, "Subsection",ExpressionUUID->"b4c35bc8-8ad6-4764-9928-07fc702caa09"],
Cell[26639, 589, 147, 2, 44, "Text",ExpressionUUID->"db2f2751-3940-4967-a312-8d629d65a877"],
Cell[26789, 593, 666, 12, 90, "Input",ExpressionUUID->"487948c1-3000-4207-b554-0d2d4786a266"],
Cell[27458, 607, 533, 10, 102, "Text",ExpressionUUID->"6d9a5f51-4995-4310-bf37-048291157307"],
Cell[27994, 619, 646, 11, 116, "Input",ExpressionUUID->"88d4a77a-bb7b-4c76-a67a-ea89c8c9f1f4"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[28689, 636, 176, 3, 84, "Section",ExpressionUUID->"8605de96-e1a3-4e53-9a11-5e067f6f42d0"],
Cell[28868, 641, 631, 14, 73, "Text",ExpressionUUID->"b2ed6d60-aa53-4c86-a985-8a782b264825"],
Cell[29502, 657, 1056, 21, 103, "Text",ExpressionUUID->"14ed9cc6-f968-4fc9-8017-a8ac224078e4"],
Cell[30561, 680, 2785, 65, 286, "Input",ExpressionUUID->"5c4d3239-331a-4f09-8122-eb6946130f48"],
Cell[33349, 747, 395, 8, 73, "Text",ExpressionUUID->"e91a6b1f-52e2-468b-8f3c-dcd69829ff2b"],
Cell[33747, 757, 559, 13, 38, "Input",ExpressionUUID->"6f6cbef8-855d-4a8d-89f2-2ece457c78d6"],
Cell[34309, 772, 2385, 54, 282, "Text",ExpressionUUID->"6cac5f9f-b846-4f6e-b4b9-780296c9d1d0"],
Cell[36697, 828, 856, 14, 116, "Input",ExpressionUUID->"0c4fb030-f9f3-4584-96ec-37ea671659c9"],
Cell[CellGroupData[{
Cell[37578, 846, 131, 0, 67, "Subsection",ExpressionUUID->"7374b566-51c7-485c-93f3-f7d499ac58ec"],
Cell[37712, 848, 249, 6, 44, "Text",ExpressionUUID->"0eecea16-515d-44ff-846e-58dbe13fee17"],
Cell[37964, 856, 241, 6, 44, "Text",ExpressionUUID->"94efd16e-c013-4f79-8c62-383ccfc89a45"],
Cell[38208, 864, 2141, 42, 272, "Input",ExpressionUUID->"e0306241-b024-45d8-995c-46e936437869"],
Cell[40352, 908, 181, 3, 44, "Text",ExpressionUUID->"0ece89d0-e39c-4068-9c31-cfdc39dd2314"],
Cell[40536, 913, 336, 7, 56, "Input",ExpressionUUID->"058c868c-a8b4-4510-859a-2382e5fc7727"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[40921, 926, 187, 3, 84, "Section",ExpressionUUID->"0ebb6802-ac6b-450b-b488-dc56bfd34a3f"],
Cell[41111, 931, 365, 8, 73, "Text",ExpressionUUID->"89e826e3-e4dc-4e1b-807b-4120eb117b2e"],
Cell[41479, 941, 596, 12, 116, "Input",ExpressionUUID->"fa9ab662-591c-49b0-84a2-1cd92270e6c5"],
Cell[42078, 955, 1020, 20, 168, "Input",ExpressionUUID->"35112bfb-1235-4620-ba54-790112fdb5e6"],
Cell[43101, 977, 500, 9, 131, "Text",ExpressionUUID->"5d200428-c6ed-4781-95f9-07af6c8f6707"],
Cell[43604, 988, 181, 3, 44, "Text",ExpressionUUID->"e6d4c3cd-a70c-467b-bbbf-041a1e761b85"],
Cell[43788, 993, 353, 8, 56, "Input",ExpressionUUID->"30a32762-c7a0-446e-b532-4d8bb51766d4"]
}, Open  ]]
}, Open  ]]
}
]
*)

